<div class="form-group mb-2">
    <input type="text" name="name" class="form-control mb-2" placeholder="Име и фамилия" value="{{ address.name|default:'' }}" required />
</div>
<div class="form-group mb-2">
    <input type="text" name="face" class="form-control mb-2" placeholder="Лице за контакт (за юридически лица)" value="{{ address.face|default:'' }}" />
</div>
<div class="form-group mb-2">
    <input type="text" name="phone" class="form-control mb-2" placeholder="Телефон" value="{{ address.phone|default:'' }}" required />
</div>
<div class="form-group mb-2">
    <input type="email" name="email" class="form-control mb-2" placeholder="Имейл" value="{{ address.email|default:'' }}" required />
</div>
<div class="form-group mb-2">
    <select name="delivery_method" id="delivery-method-select" class="form-control rounded" required>
        <option value="">Изберете метод на доставка</option>
        <option value="econt_office" {% if address.delivery_method == "econt_office" or delivery_method == "econt_office" %}selected{% endif %}>Еконт офис</option>
        <option value="econt" {% if address.delivery_method == "econt" or delivery_method == "econt" %}selected{% endif %}>Еконт адрес</option>
        <option value="speedy_office" {% if address.delivery_method == "speedy_office" or delivery_method == "speedy_office" %}selected{% endif %}>Спиди офис</option>
        <option value="speedy" {% if address.delivery_method == "speedy" or delivery_method == "speedy" %}selected{% endif %}>Спиди адрес</option>
    </select>
</div>
<div class="form-group mb-2">
    <input type="text" name="city" class="form-control mb-2" placeholder="Град" value="{{ address.city|default:'' }}" required />
</div>
<div class="form-group mb-2">
    <input type="text" name="address" class="form-control mb-2" placeholder="Адрес" value="{{ address.address|default:'' }}" />
</div>
<div class="form-group mb-2" id="econt-office-fields" style="display: none;">
    <input type="text" name="office_name" class="form-control mb-2" placeholder="Офис на Еконт/Спиди" value="{{ address.office_name|default:'' }}" />
</div>
<script>
document.addEventListener('DOMContentLoaded', function () {
    function toggleFields() {
        var method = document.getElementById('delivery-method-select').value;
        var addressInputEl = document.querySelector('[name="address"]');
        var addressField = addressInputEl.closest('.form-group');
        var officeField = document.getElementById('econt-office-fields');
        var officeInputEl = officeField.querySelector('[name="office_name"]');

        if (method === 'econt_office' || method === 'speedy_office') {
            officeField.style.display = '';
            addressField.style.display = 'none';
            if (officeInputEl) officeInputEl.required = true;
            if (addressInputEl) addressInputEl.required = false;
        } else {
            officeField.style.display = 'none';
            addressField.style.display = '';
            if (officeInputEl) officeInputEl.required = false;
            if (addressInputEl) addressInputEl.required = true;
        }
    }
    document.getElementById('delivery-method-select').addEventListener('change', toggleFields);
    // Call once to set the correct initial state
    toggleFields();
});
</script>
